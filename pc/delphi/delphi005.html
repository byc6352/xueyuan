<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Delphi中TWebBrowser的用法</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><div id="article_content" class="article_content clearfix">
                                    
                                        
                <div class="htmledit_views" id="content_views">
</div></div><ul><li><span><span>WebBrowser1</span><span>.</span>GoHome;&nbsp;<span>//到浏览器默认主页</span>&nbsp;&nbsp;</span></li><li><span><span>WebBrowser1<span>.</span>Refresh;&nbsp;</span><span>//刷新</span>&nbsp;&nbsp;</span></li><li><span><span>WebBrowser1<span>.</span>GoBack;&nbsp;</span><span>//后退</span>&nbsp;&nbsp;</span></li><li><span><span>WebBrowser1<span>.</span>GoForward;&nbsp;</span><span>//前进</span>&nbsp;&nbsp;</span></li><li><span><span>WebBrowser1<span>.</span>Navigate(</span><span>'...'</span>);&nbsp;<span>//打开指定页面</span>&nbsp;&nbsp;</span></li><li><span><span>WebBrowser1<span>.</span>Navigate(</span><span>'about:blank'</span>);&nbsp;<span>//打开空页面</span>&nbsp;&nbsp;</span></li><li><span><span><span>//打开空页面,&nbsp;并写入...</span>&nbsp;&nbsp;</span></span></li><li>&nbsp;&nbsp;</li><li><span><span>WebBrowser1<span>.</span>Navigate(</span><span>'about:&lt;head&gt;&lt;title&gt;标题&lt;/title&gt;&lt;body&gt;页面内容&lt;/body&gt;'</span>);&nbsp;&nbsp;</span></li><li><span><span><span>//读取网页脚本中的变量:</span>&nbsp;&nbsp;</span></span></li><li><span><span>&nbsp;&nbsp;</span></span></li><li><span><span><span>procedure</span>&nbsp;TForm1</span><span>.</span>Button1Click(Sender:&nbsp;TObject);&nbsp;&nbsp;</span></li><li><span><span><span>var</span>&nbsp;&nbsp;</span></span></li><li><span><span>s:&nbsp;<span>string</span>;&nbsp;&nbsp;</span></span></li><li><span><span>i:&nbsp;Integer;&nbsp;&nbsp;</span></span></li><li><span><span><span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span>s&nbsp;:=&nbsp;WebBrowser1<span>.</span>OleObject</span><span>.</span>document<span>.</span>Script<span>.</span>str;&nbsp;&nbsp;</span></li><li><span><span>i&nbsp;:=&nbsp;WebBrowser1<span>.</span>OleObject</span><span>.</span>document<span>.</span>Script<span>.</span>num;&nbsp;&nbsp;</span></li><li><span><span>ShowMessage(s);&nbsp;<span>//Hello</span>&nbsp;&nbsp;</span></span></li><li><span><span>ShowMessage(IntToStr(i));&nbsp;<span>//99</span>&nbsp;&nbsp;</span></span></li><li><span><span>&nbsp;&nbsp;</span></span></li><li><span><span><span>//也可以这样读:</span>&nbsp;&nbsp;</span></span></li><li><span><span>s&nbsp;:=&nbsp;WebBrowser1<span>.</span>OleObject</span><span>.</span>document<span>.</span>parentWindow<span>.</span>str;&nbsp;&nbsp;</span></li><li><span><span>i&nbsp;:=&nbsp;WebBrowser1<span>.</span>OleObject</span><span>.</span>document<span>.</span>parentWindow<span>.</span>num;&nbsp;&nbsp;</span></li><li><span><span>ShowMessage(s);&nbsp;<span>//Hello</span>&nbsp;&nbsp;</span></span></li><li><span><span>ShowMessage(IntToStr(i));&nbsp;<span>//99</span>&nbsp;&nbsp;</span></span></li><li><span><span><span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span>&amp;amp;lt;br&amp;amp;gt;假如网页中有这样的语句:&amp;amp;lt;br&amp;amp;gt;&amp;amp;amp;amp;lt;script&amp;amp;amp;amp;gt;&amp;amp;lt;br&amp;amp;gt;<span>var</span>&amp;amp;lt;br&amp;amp;gt;&nbsp;str&nbsp;=&nbsp;&amp;amp;quot;Hello&amp;amp;quot;;&amp;amp;lt;br&amp;amp;gt;&nbsp;i&nbsp;=&nbsp;</span><span>99</span>;&amp;amp;lt;br&amp;amp;gt;&amp;amp;amp;amp;lt;/script&amp;amp;amp;amp;gt;&nbsp;&nbsp;</span></li><li><span><span><span>//调用网页脚本中的函数:</span>&nbsp;&nbsp;</span></span></li><li><span><span>&nbsp;&nbsp;</span></span></li><li><span><span><span>procedure</span>&nbsp;TForm1</span><span>.</span>Button1Click(Sender:&nbsp;TObject);&nbsp;&nbsp;</span></li><li><span><span><span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span>WebBrowser1<span>.</span>OleObject</span><span>.</span>document<span>.</span>parentWindow<span>.</span>MB();&nbsp;<span>//HTML-Js</span>&nbsp;&nbsp;</span></li><li><span><span>&nbsp;&nbsp;</span></span></li><li><span><span><span>//如需指定脚本语言,&nbsp;需要:</span>&nbsp;&nbsp;</span></span></li><li><span><span>WebBrowser1<span>.</span>OleObject</span><span>.</span>document<span>.</span>parentWindow<span>.</span>execScript(<span>'MB()'</span>,<span>'JavaScript'</span>);&nbsp;<span>//HTML-Js</span>&nbsp;&nbsp;</span></li><li><span><span><span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span>&amp;amp;lt;br&amp;amp;gt;假如有这样的脚本:&amp;amp;lt;br&amp;amp;gt;&amp;amp;amp;amp;lt;script&amp;amp;amp;amp;gt;&amp;amp;lt;br&amp;amp;gt;<span>function</span>&nbsp;MB()</span><span>{&nbsp;&amp;amp;lt;br&amp;amp;gt;&nbsp;alert('HTML-Js');&amp;amp;lt;br&amp;amp;gt;}</span>&amp;amp;lt;br&amp;amp;gt;&amp;amp;amp;amp;lt;/script&amp;amp;amp;amp;gt;&nbsp;&nbsp;</span></li><li><span><span>&nbsp;&nbsp;</span></span></li><li><span><span>&nbsp;&nbsp;</span></span></li><li><span><span><span>//判断网页及内部框架网页是否全部下载完毕</span>&nbsp;&nbsp;</span></span></li><li><span><span>&nbsp;&nbsp;</span></span></li><li><span><span><span>procedure</span>&nbsp;TForm1</span><span>.</span>WebBrowser1DocumentComplete(ASender:&nbsp;TObject;&nbsp;&nbsp;</span></li><li><span><span><span>const</span>&nbsp;pDisp:&nbsp;IDispatch;&nbsp;</span><span>var</span>&nbsp;URL:&nbsp;OleVariant);&nbsp;&nbsp;</span></li><li><span><span><span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span><span>if</span>&nbsp;&nbsp;&nbsp;</span><span>not</span>(&lt;span&nbsp;style="font-family:&nbsp;Arial,&nbsp;Helvetica,&nbsp;sans-serif;"&gt;WebBrowser1&lt;/span&gt;.Busy)&nbsp;&nbsp;&nbsp;<span>then</span>&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span><span>&nbsp;&nbsp;ShowMessage(<span>'下载完毕'</span>);&nbsp;&nbsp;&nbsp;</span></span></li><li><span><span><span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span>&nbsp;&nbsp;</span></span></li><li><span><span><span>//改变背景色或背景图片:</span>&nbsp;&nbsp;</span></span></li><li><span><span>WebBrowser1<span>.</span>OleObject</span><span>.</span>document<span>.</span>body<span>.</span>bgcolor&nbsp;:=&nbsp;<span>'#FF0000'</span>;&nbsp;&nbsp;</span></li><li><span><span>WebBrowser1<span>.</span>OleObject</span><span>.</span>document<span>.</span>body<span>.</span>background&nbsp;:=&nbsp;<span>'...图片地址'</span>;&nbsp;&nbsp;</span></li><li><span><span><span>//操作有&nbsp;ID&nbsp;标签的对象:</span>&nbsp;&nbsp;</span></span></li><li><span><span><span>var</span>&nbsp;&nbsp;</span></span></li><li><span><span>s:&nbsp;<span>string</span>;&nbsp;&nbsp;</span></span></li><li><span><span><span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span>s&nbsp;:=&nbsp;WebBrowser1<span>.</span>OleObject</span><span>.</span>document<span>.</span>getElementByIdx_x(<span>'span1'</span>).innerText;&nbsp;&nbsp;</span></li><li><span><span>ShowMessage(s);&nbsp;<span>//这是&nbsp;span1&nbsp;标签中的内容</span>&nbsp;&nbsp;</span></span></li><li><span><span>&nbsp;&nbsp;</span></span></li><li><span><span><span>//或者:</span>&nbsp;&nbsp;</span></span></li><li><span><span>s&nbsp;:=&nbsp;WebBrowser1<span>.</span>OleObject</span><span>.</span>document<span>.</span>parentWindow<span>.</span>span1<span>.</span>innerText;&nbsp;&nbsp;</span></li><li><span><span>ShowMessage(s);&nbsp;<span>//这是&nbsp;span1&nbsp;标签中的内容</span>&nbsp;&nbsp;</span></span></li><li><span><span>&nbsp;&nbsp;</span></span></li><li><span><span><span>//隐藏它:</span>&nbsp;&nbsp;</span></span></li><li><span><span>WebBrowser1<span>.</span>OleObject</span><span>.</span>document<span>.</span>parentWindow<span>.</span>span1<span>.</span>style<span>.</span>display&nbsp;:=&nbsp;<span>'none'</span>;&nbsp;&nbsp;</span></li><li><span><span><span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span>&amp;amp;lt;br&amp;amp;gt;假如网页中有这样的内容:&amp;amp;lt;br&amp;amp;gt;&amp;amp;amp;amp;lt;span&nbsp;id=span1&amp;amp;amp;amp;gt;这是&nbsp;span1&nbsp;标签中的内容&amp;amp;amp;amp;lt;/span&amp;amp;amp;amp;gt;&amp;amp;lt;br&amp;amp;gt;&nbsp;&nbsp;</span></span></li><li><span><span><span>//获取网页源代码</span>&nbsp;&nbsp;</span></span></li><li><span><span><span>var</span>&nbsp;&nbsp;</span></span></li><li><span><span>s:&nbsp;<span>string</span>;&nbsp;&nbsp;</span></span></li><li><span><span><span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span>s&nbsp;:=&nbsp;WebBrowser1<span>.</span>OleObject</span><span>.</span>document<span>.</span>body<span>.</span>innerHTML;&nbsp;<span>//body内的所有代码</span>&nbsp;&nbsp;</span></li><li><span><span>s&nbsp;:=&nbsp;WebBrowser1<span>.</span>OleObject</span><span>.</span>document<span>.</span>body<span>.</span>outerHTML;&nbsp;<span>//body内的所有代码,&nbsp;包含body标签</span>&nbsp;&nbsp;</span></li><li><span><span>s&nbsp;:=&nbsp;WebBrowser1<span>.</span>OleObject</span><span>.</span>document<span>.</span>documentElement<span>.</span>innerHTML;&nbsp;<span>//html内的所有代码</span>&nbsp;&nbsp;</span></li><li><span><span><span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span>&lt;/pre&gt;&lt;pre&nbsp;name="code"&nbsp;<span>class</span>="delphi"&gt;&lt;span&nbsp;style="color:&nbsp;rgb(</span><span>73</span>,&nbsp;<span>73</span>,&nbsp;<span>73</span>);&nbsp;font-family:&nbsp;simsun;&nbsp;font-size:&nbsp;14px;&nbsp;line-height:&nbsp;21px;"&gt;Memo1<span>.</span>Lines<span>.</span>Add(IHtmlDocument2(WebBrowser1<span>.</span>Document).Body<span>.</span>OuterHtml);&lt;/span&gt;&nbsp;&nbsp;</span></li><li><span><span>&nbsp;&nbsp;</span></span></li><li><span><span><span>//获取网页全部源代码</span>&nbsp;&nbsp;</span></span></li><li><span><span><span>uses</span>&nbsp;ActiveX;&nbsp;&nbsp;</span></span></li><li><span><span><span>var</span>&nbsp;&nbsp;</span></span></li><li><span><span>ms:&nbsp;TMemoryStream;&nbsp;&nbsp;</span></span></li><li><span><span><span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span><span>if</span>&nbsp;</span><span>not</span>&nbsp;Assigned(WebBrowser1<span>.</span>Document)&nbsp;<span>then</span>&nbsp;Exit;&nbsp;&nbsp;</span></li><li><span><span>ms&nbsp;:=&nbsp;TMemoryStream<span>.</span>Create;&nbsp;&nbsp;</span></span></li><li><span><span>(WebBrowser1<span>.</span>Document&nbsp;</span><span>as</span>&nbsp;IPersistStreamInit).Save(TStreamAdapter<span>.</span>Create(ms),&nbsp;True);&nbsp;&nbsp;</span></li><li><span><span>ms<span>.</span>Position&nbsp;:=&nbsp;</span><span>0</span>;&nbsp;&nbsp;</span></li><li><span><span>Memo1<span>.</span>Lines</span><span>.</span>LoadFromStream(ms,&nbsp;TEncoding<span>.</span>UTF8);&nbsp;&nbsp;</span></li><li><span><span><span>//&nbsp;Memo1.Lines.LoadFromStream(ms,&nbsp;TEncoding.Default);&nbsp;{GB2312&nbsp;等双字节}</span>&nbsp;&nbsp;</span></span></li><li><span><span>ms<span>.</span>Free;&nbsp;&nbsp;</span></span></li><li><span><span><span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span><span>//WebBrowser&nbsp;中的右键菜单</span>&nbsp;&nbsp;</span></span></li><li><span><span>&nbsp;&nbsp;</span></span></li><li><span><span><span>//先要添加ApplicationEvents1,指定其Message事件</span>&nbsp;&nbsp;</span></span></li><li><span><span>&nbsp;&nbsp;</span></span></li><li><span><span><span>//屏蔽右键菜单</span>&nbsp;&nbsp;</span></span></li><li><span><span><span>procedure</span>&nbsp;TForm1</span><span>.</span>ApplicationEvents1Message(<span>var</span>&nbsp;Msg:&nbsp;tagMSG;&nbsp;<span>var</span>&nbsp;Handled:&nbsp;Boolean);&nbsp;&nbsp;</span></li><li><span><span><span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span><span>with</span>&nbsp;Msg&nbsp;</span><span>do</span>&nbsp;&nbsp;</span></li><li><span><span><span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span><span>if</span>&nbsp;</span><span>not</span>&nbsp;IsChild(WebBrowser1<span>.</span>Handle,&nbsp;hWnd)&nbsp;<span>then</span>&nbsp;Exit;&nbsp;&nbsp;</span></li><li><span><span>Handled&nbsp;:=&nbsp;(message&nbsp;=&nbsp;WM_RBUTTONDOWN)&nbsp;<span>or</span>&nbsp;(message&nbsp;=&nbsp;WM_RBUTTONUP)&nbsp;</span><span>or</span>&nbsp;(message&nbsp;=&nbsp;WM_CONTEXTMENU);&nbsp;&nbsp;</span></li><li><span><span><span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span><span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span>&nbsp;&nbsp;</span></span></li><li><span><span><span>//替换右键菜单</span>&nbsp;&nbsp;</span></span></li><li><span><span><span>procedure</span>&nbsp;TForm1</span><span>.</span>ApplicationEvents1Message(<span>var</span>&nbsp;Msg:&nbsp;tagMSG;&nbsp;<span>var</span>&nbsp;Handled:&nbsp;Boolean);&nbsp;&nbsp;</span></li><li><span><span><span>var</span>&nbsp;mPoint:&nbsp;TPoint;&nbsp;&nbsp;</span></span></li><li><span><span><span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span><span>if</span>&nbsp;IsChild(WebBrowser1</span><span>.</span>Handle,&nbsp;Msg<span>.</span>Hwnd)&nbsp;<span>and</span>&nbsp;&nbsp;</span></li><li><span><span>((Msg<span>.</span>Message&nbsp;=&nbsp;WM_RBUTTONDOWN)&nbsp;</span><span>or</span>&nbsp;(Msg<span>.</span>Message&nbsp;=&nbsp;WM_RBUTTONUP))&nbsp;<span>then</span>&nbsp;&nbsp;</span></li><li><span><span><span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span>GetCursorPos(mPoint);&nbsp;<span>//得到光标位置</span>&nbsp;&nbsp;</span></span></li><li><span><span>PopupMenu1<span>.</span>Popup(mPoint</span><span>.</span>X,&nbsp;mPoint<span>.</span>Y);&nbsp;<span>//弹出popupmenu1的菜单</span>&nbsp;&nbsp;</span></li><li><span><span>Handled:=True;&nbsp;&nbsp;</span></span></li><li><span><span><span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span><span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span><span>//新页面写入</span>&nbsp;&nbsp;</span></span></li><li><span><span><span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span>WebBrowser1<span>.</span>Navigate(</span><span>'about:blank'</span>);&nbsp;&nbsp;</span></li><li><span><span>WebBrowser1<span>.</span>OleObject</span><span>.</span>Document<span>.</span>Writeln(<span>'ok'</span>);&nbsp;&nbsp;</span></li><li><span><span><span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span>&nbsp;&nbsp;</span></span></li><li><span><span><span>//从流中写入:</span>&nbsp;&nbsp;</span></span></li><li><span><span><span>var</span>&nbsp;&nbsp;</span></span></li><li><span><span>ms:&nbsp;TMemoryStream;&nbsp;&nbsp;</span></span></li><li><span><span><span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span>ms&nbsp;:=&nbsp;TMemoryStream<span>.</span>Create;&nbsp;&nbsp;</span></span></li><li><span><span>Memo1<span>.</span>Lines</span><span>.</span>SaveToStream(ms);&nbsp;&nbsp;</span></li><li><span><span>ms<span>.</span>Position&nbsp;:=&nbsp;</span><span>0</span>;&nbsp;&nbsp;</span></li><li><span><span>(WebBrowser1<span>.</span>Document&nbsp;</span><span>as</span>&nbsp;IPersistStreamInit).Load(TStreamAdapter<span>.</span>Create(ms));&nbsp;&nbsp;</span></li><li><span><span>ms<span>.</span>Free;&nbsp;&nbsp;</span></span></li><li><span><span><span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span>&nbsp;&nbsp;</span></span></li><li><span><span><span>//禁止提示脚步错误</span>&nbsp;&nbsp;</span></span></li><li><span><span><span>procedure</span>&nbsp;TForm1</span><span>.</span>WebBrowser1NavigateComplete2(ASender:&nbsp;TObject;&nbsp;&nbsp;</span></li><li><span><span><span>const</span>&nbsp;pDisp:&nbsp;IDispatch;&nbsp;</span><span>var</span>&nbsp;URL:&nbsp;OleVariant);&nbsp;&nbsp;</span></li><li><span><span><span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span>WebBrowser1<span>.</span>Silent&nbsp;:=&nbsp;True;&nbsp;&nbsp;</span></span></li><li><span><span><span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span>&lt;/pre&gt;&lt;pre&nbsp;name="code"&nbsp;<span>class</span>="delphi"&gt;方法二&nbsp;&nbsp;</span></span></li><li><span><span>TWebBrowser的OnDownloadComplete事件里面执行&nbsp;&nbsp;</span></span></li><li><span><span>(WebBrowser1<span>.</span>Document&nbsp;</span><span>as</span>&nbsp;IHTMLDocument2).parentWindow<span>.</span>execScript(<span>'window.οnerrοr=function(){return&nbsp;true}'</span>,<span>'JavaScript'</span>);&nbsp;&nbsp;</span></li><li><span><span>&nbsp;&nbsp;</span></span></li><li><span><span>&lt;/pre&gt;&lt;pre&nbsp;name="code"&nbsp;<span>class</span>="delphi"&gt;</span><span>//禁止弹出窗口</span>&nbsp;&nbsp;</span></li><li><span><span><span>procedure</span>&nbsp;TForm1</span><span>.</span>WebBrowser1NewWindow2(ASender:&nbsp;TObject;&nbsp;<span>var</span>&nbsp;ppDisp:&nbsp;IDispatch;&nbsp;&nbsp;</span></li><li><span><span><span>var</span>&nbsp;Cancel:&nbsp;WordBool);&nbsp;&nbsp;</span></span></li><li><span><span><span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span>Cancel&nbsp;:=&nbsp;True;&nbsp;&nbsp;</span></span></li><li><span><span><span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span>&lt;/pre&gt;&lt;pre&nbsp;name="code"&nbsp;<span>class</span>="delphi"&gt;</span><span>//使WebBrowser获得焦点</span>&nbsp;&nbsp;</span></li><li><span><span>　　TWebBrowser非常特殊，它从TWinControl继承来的SetFocus方法并不能使得它所twebbrows&nbsp;setfocu&nbsp;方法包含的文档获得焦点，从而不能立即使用Internet&nbsp;Explorer本身具有得internet&nbsp;explor&nbsp;使用快捷键，解决方法如下：&lt;&nbsp;&nbsp;</span></span></li><li><span><span>　　<span>procedure</span>&nbsp;TForm1</span><span>.</span>SetFocusToDoc;&nbsp;&nbsp;</span></li><li><span><span>　　<span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span>　　　<span>if</span>&nbsp;WebBrowser1</span><span>.</span>Document&nbsp;&lt;&gt;&nbsp;<span>nil</span>&nbsp;<span>then</span>&nbsp;&nbsp;</span></li><li><span><span>　　　　<span>with</span>&nbsp;WebBrowser1</span><span>.</span>Application&nbsp;<span>as</span>&nbsp;Ioleobject&nbsp;<span>do</span>&nbsp;&nbsp;</span></li><li><span><span>　　　　　DoVerb(OLEIVERB_UIACTIVATE,&nbsp;<span>nil</span>,&nbsp;WebBrowser1,&nbsp;</span><span>0</span>,&nbsp;Handle,&nbsp;GetClientRect);&nbsp;&nbsp;</span></li><li><span><span>　　<span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span>　　除此之外，我还找到一种更简单的方法，这里一并列除此之外这里并列出：&nbsp;&nbsp;</span></span></li><li><span><span>　　<span>if</span>&nbsp;WebBrowser1</span><span>.</span>Document&nbsp;&lt;&gt;&nbsp;<span>nil</span>&nbsp;<span>then</span>&nbsp;&nbsp;</span></li><li><span><span>　　　IHTMLWindow2(IHTMLDocument2(WebBrowser1<span>.</span>Document).ParentWindow).focus&nbsp;&nbsp;</span></span></li><li><span><span>　　刚找到了更简单的方法，也许是最简单的：&nbsp;&nbsp;</span></span></li><li><span><span>　　<span>if</span>&nbsp;WebBrowser1</span><span>.</span>Document&nbsp;&lt;&gt;&nbsp;<span>nil</span>&nbsp;<span>then</span>&nbsp;&nbsp;</span></li><li><span><span>　　　IHTMLWindow4(WebBrowser1<span>.</span>Document).focus&nbsp;&nbsp;</span></span></li><li><span><span>　　还有，需要判断文档是否获得焦点这样来做：&nbsp;&nbsp;</span></span></li><li><span><span>　　<span>if</span>&nbsp;IHTMLWindow4(WebBrowser1</span><span>.</span>Document).hasfocus&nbsp;<span>then</span>&nbsp;&nbsp;</span></li><li><span><span>&lt;/pre&gt;&lt;pre&nbsp;name="code"&nbsp;<span>class</span>="delphi"&gt;&nbsp;&nbsp;</span></span></li><li><span><span><span>//查找内容</span>&nbsp;&nbsp;</span></span></li><li><span><span>　　查找对话框可以在文档获得焦点的时候通过按键Ctrl-F对话框焦点按键来调出，程序中则调用IOleCommandTarget对象的成员函数Exec执行OLECMDID_FIND操作olecmdid&nbsp;操作执行来调用，下面给出的方法是如何在程序中用代码来做出文下面方法如何字选择，即你可以自己设计查找对话框。&nbsp;&nbsp;</span></span></li><li><span><span>　　　Var&nbsp;&nbsp;</span></span></li><li><span><span>　　　　Doc:&nbsp;IHtmlDocument2;&nbsp;&nbsp;</span></span></li><li><span><span>　　　　TxtRange:&nbsp;IHtmlTxtRange;&nbsp;&nbsp;</span></span></li><li><span><span>　　　<span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span>　　　　Doc&nbsp;:=WebBrowser1<span>.</span>Document&nbsp;</span><span>as</span>&nbsp;IHtmlDocument2;&nbsp;&nbsp;</span></li><li><span><span>　　　　Doc<span>.</span>SelectAll;　　　　</span><span>//此处为简写，选择全部文档的方法selectal&nbsp;方法文档请参见第三条命令操作</span>&nbsp;&nbsp;</span></li><li><span><span>　　　　　　　　　　　　　　　　<span>//这句话尤为重要，因重要尤为为IHtmlTxtRange对象的方法能够操作的前提是</span>&nbsp;&nbsp;</span></span></li><li><span><span>　　　　　　　　　　　　　　　　<span>//Document已经有一个文字选document&nbsp;文字一个择区域。由于接着执行下面的语句，所以不会</span>&nbsp;&nbsp;</span></span></li><li><span><span>　　　　　　　　　　　　　　　　<span>//看到文档全选的过程看到过程文档。</span>&nbsp;&nbsp;</span></span></li><li><span><span>　　　　TxtRange&nbsp;:=Doc<span>.</span>Selection</span><span>.</span>CreateRange&nbsp;<span>as</span>&nbsp;IHtmlTxtRange;&nbsp;&nbsp;</span></li><li><span><span>　　　　TxtRange<span>.</span>FindText(</span><span>'Text&nbsp;to&nbsp;be&nbsp;searched'</span>,<span>0.0</span>);&nbsp;&nbsp;</span></li><li><span><span>　　　　TxtRange<span>.</span>Select;&nbsp;&nbsp;</span></span></li><li><span><span>　　　<span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span>　　还有，从Txt<span>.</span>Get_text可以得到当前选中的文字内容，某些得到文字当前时候是有用的。&nbsp;&nbsp;</span></span></li><li><span><span>&nbsp;&nbsp;</span></span></li><li><span><span>&lt;/pre&gt;&lt;pre&nbsp;name="code"&nbsp;<span>class</span>="delphi"&gt;</span><span>//点击“提交”按钮</span>&nbsp;&nbsp;</span></li><li><span><span>　　如同程序里每个窗体上有一个“缺省”按钮一样，Web一样按钮每个页面上的每个Form也有一个“缺省”按钮——即属性为“Submitsubmit&nbsp;form&nbsp;按钮”的按钮，当用户按下回车键时就相当于鼠标单击了“Submitsubmit&nbsp;回车键相当”。但是TWebBrowser似乎并不响应回车键，并且，即使把包含TWebBrowser的twebbrows&nbsp;回车键似乎窗体的KeyPreview设为True，在窗体的KeyPress事件里还是不能截获用户向keypreview&nbsp;keypress&nbsp;事件TWebBrowser发出的按键。&nbsp;&nbsp;</span></span></li><li><span><span>　　我的解决办法是用ApplicatinEvents构件或者自己编写Tapplication对象的OnMessage事onmessag&nbsp;tapplic&nbsp;构件件，在其中判断消息类型，对键盘消息做出响应。至于点至于响应判断击“提交”按钮，可以通过分析网页源代码的方法来实现源代码网页方法，不过我找到了更为简单快捷的方法，有两种，第一种是更为不过方法我自己想出来的，另一种是别人写的代码，这里都提供给自己这里出来大家，以做参考。&nbsp;&nbsp;</span></span></li><li><span><span>　　A、用SendKeys函数向WebBrowser发送回车键&nbsp;&nbsp;</span></span></li><li><span><span>　　　&nbsp;在Delphi5光盘上的Info/Extras/SendKeys目录下有一个SndKey32<span>.</span>pas文件，sendkei&nbsp;delphi&nbsp;sndkei其中包含了两个函数SendKeys和AppActivate，我们可以用SendKeys函数来向WebBrowser发appactiv&nbsp;webbrows&nbsp;sendkei送回车键，我现在用的就是这个方法，使用很简单，在WebBrowserwebbrows&nbsp;回车键使用获得焦点的情况下（不要求WebBrowser所包含的文档获得焦点），webbrows&nbsp;焦点包含用一条语句即可：&nbsp;&nbsp;</span></span></li><li><span><span>　　　Sendkeys(<span>'~'</span>,</span><span>true</span>);<span>//&nbsp;press&nbsp;RETURN&nbsp;key</span>&nbsp;&nbsp;</span></li><li><span><span>　　　SendKeys函数的详细参数说明等，均包含在SndKey32<span>.</span>pas文件中sendkei&nbsp;sndkei&nbsp;参数。&nbsp;&nbsp;</span></span></li><li><span><span>　　B、在OnMessage事件中将接受到的键盘消息传递给WebBrowser。&nbsp;&nbsp;</span></span></li><li><span><span>　　　Procedure&nbsp;TForm1<span>.</span>ApplicationEvents1Message(</span><span>var</span>&nbsp;Msg:&nbsp;TMsg;&nbsp;<span>var</span>&nbsp;Handled:&nbsp;Boolean);&nbsp;&nbsp;</span></li><li><span><span>　　　<span>{fixes&nbsp;the&nbsp;malfunction&nbsp;of&nbsp;some&nbsp;keys&nbsp;within&nbsp;webbrowser&nbsp;control}</span>&nbsp;&nbsp;</span></span></li><li><span><span>　　　<span>const</span>&nbsp;&nbsp;</span></span></li><li><span><span>　　　　StdKeys&nbsp;=&nbsp;[VK_TAB,&nbsp;VK_RETURN];&nbsp;<span>{&nbsp;standard&nbsp;keys&nbsp;}</span>&nbsp;&nbsp;</span></span></li><li><span><span>　　　　ExtKeys&nbsp;=&nbsp;[VK_DELETE,&nbsp;VK_BACK,&nbsp;VK_LEFT,&nbsp;VK_RIGHT];&nbsp;<span>{&nbsp;extended&nbsp;keys&nbsp;}</span>&nbsp;&nbsp;</span></span></li><li><span><span>　　　　fExtended&nbsp;=&nbsp;<span>$01000000</span>;&nbsp;</span><span>{&nbsp;extended&nbsp;key&nbsp;flag&nbsp;}</span>&nbsp;&nbsp;</span></li><li><span><span>　　　<span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span>　　　　Handled&nbsp;:=&nbsp;False;&nbsp;&nbsp;</span></span></li><li><span><span>　　　　<span>with</span>&nbsp;Msg&nbsp;</span><span>do</span>&nbsp;&nbsp;</span></li><li><span><span>　　　　<span>if</span>&nbsp;((Message&nbsp;&gt;=&nbsp;WM_KEYFIRST)&nbsp;</span><span>and</span>&nbsp;(Message&nbsp;&lt;=&nbsp;WM_KEYLAST))&nbsp;<span>and</span>&nbsp;&nbsp;</span></li><li><span><span>　　　　　((wParam&nbsp;<span>in</span>&nbsp;StdKeys)&nbsp;</span><span>or</span>&nbsp;&nbsp;</span></li><li><span><span>　　　　　<span>{$IFDEF&nbsp;VER120}(GetKeyState(VK_CONTROL)&nbsp;&lt;&nbsp;0)&nbsp;or&nbsp;{$ENDIF}</span>&nbsp;&nbsp;</span></span></li><li><span><span>　　　　　(wParam&nbsp;<span>in</span>&nbsp;ExtKeys)&nbsp;</span><span>and</span>&nbsp;&nbsp;</span></li><li><span><span>　　　　　((lParam&nbsp;<span>and</span>&nbsp;fExtended)&nbsp;=&nbsp;fExtended))&nbsp;</span><span>then</span>&nbsp;&nbsp;</span></li><li><span><span>　　　　<span>try</span>&nbsp;&nbsp;</span></span></li><li><span><span>　　　　　<span>if</span>&nbsp;IsChild(Handle,&nbsp;hWnd)&nbsp;</span><span>then</span>&nbsp;<span>{&nbsp;handles&nbsp;all&nbsp;browser&nbsp;related&nbsp;messages&nbsp;}</span>&nbsp;&nbsp;</span></li><li><span><span>　　　　　<span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span>　　　　　　<span>with</span>&nbsp;</span><span>{$IFDEF&nbsp;VER120}Application_{$ELSE}Application{$ENDIF}</span>&nbsp;<span>as</span>&nbsp;&nbsp;</span></li><li><span><span>　　　　　　　　IOleInPlaceActiveObject&nbsp;<span>do</span>&nbsp;&nbsp;</span></span></li><li><span><span>　　　　　　　Handled&nbsp;:=&nbsp;TranslateAccelerator(Msg)&nbsp;=&nbsp;S_OK;&nbsp;&nbsp;</span></span></li><li><span><span>　　　　　　　<span>if</span>&nbsp;</span><span>not</span>&nbsp;Handled&nbsp;<span>then</span>&nbsp;&nbsp;</span></li><li><span><span>　　　　　　　<span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span>　　　　　　　　Handled&nbsp;:=&nbsp;True;&nbsp;&nbsp;</span></span></li><li><span><span>　　　　　　　　TranslateMessage(Msg);&nbsp;&nbsp;</span></span></li><li><span><span>　　　　　　　　DispatchMessage(Msg);&nbsp;&nbsp;</span></span></li><li><span><span>　　　　　　　<span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span>　　　　　　　<span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span>　　　　<span>except</span>&nbsp;&nbsp;</span></span></li><li><span><span>　　　　<span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span>　　　<span>end</span>;&nbsp;</span><span>//&nbsp;MessageHandler</span>&nbsp;&nbsp;</span></li><li><span><span>&lt;/pre&gt;&lt;pre&nbsp;name="code"&nbsp;<span>class</span>="delphi"&gt;&nbsp;&nbsp;</span></span></li><li><span><span>&lt;/pre&gt;&lt;pre&nbsp;name="code"&nbsp;<span>class</span>="delphi"&gt;</span><span>10</span>、提取网页中所有链接&nbsp;&nbsp;</span></li><li><span><span>　　这个方法来自大富翁论坛hopfield朋友的对一个问题的回答hopfield&nbsp;自大问题，我本想自己试验，但总是没成功。&nbsp;&nbsp;</span></span></li><li><span><span>　　Var&nbsp;&nbsp;</span></span></li><li><span><span>　　　doc:IHTMLDocument2;&nbsp;&nbsp;</span></span></li><li><span><span>　　　all:IHTMLElementCollection;&nbsp;&nbsp;</span></span></li><li><span><span>　　　len,I:<span>integer</span>;&nbsp;&nbsp;</span></span></li><li><span><span>　　　item:OleVariant;&nbsp;&nbsp;</span></span></li><li><span><span>　　<span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span>　　　doc:=WebBrowser1&nbsp;.Document&nbsp;<span>as</span>&nbsp;IHTMLDocument2;&nbsp;&nbsp;</span></span></li><li><span><span>　　　all:=doc<span>.</span>Get_links;　　　　　　　　　　　　　</span><span>//doc.Links亦可</span>&nbsp;&nbsp;</span></li><li><span><span>　　　len:=all<span>.</span>length;&nbsp;&nbsp;</span></span></li><li><span><span>　　　<span>for</span>&nbsp;I:=</span><span>0</span>&nbsp;<span>to</span>&nbsp;len-<span>1</span>&nbsp;<span>do</span>&nbsp;<span>begin</span>&nbsp;&nbsp;</span></li><li><span><span>　　　　item:=all<span>.</span>item(I,varempty);　　　　　　　　</span><span>//EmpryParam亦可</span>&nbsp;&nbsp;</span></li><li><span><span>　　　　memo1<span>.</span>lines</span><span>.</span>add(item<span>.</span>href);&nbsp;&nbsp;</span></li><li><span><span>　　　<span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span>　　<span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span>-----------------------------------------------------------------------------------&nbsp;&nbsp;</span></span></li><li><span><span><span>11</span>、设置TWebBrowser的编码&nbsp;&nbsp;</span></span></li><li><span><span>　　为什么我总是错过很多机会？其实早就该想到的，但为什么错过想到是一念之差，便即天壤之别。当时我要是肯再多考虑一下一念之差天壤之别当时，多试验一下，这就不会排到第１１条了。下面给出一个下面试验一个函数，搞定，难以想象的简单。&nbsp;&nbsp;</span></span></li><li><span><span>　　Procedure&nbsp;SetCharSet(AWebBrowser:&nbsp;TWebBrowser;&nbsp;ACharSet:&nbsp;String);&nbsp;&nbsp;</span></span></li><li><span><span>　　<span>var</span>&nbsp;&nbsp;</span></span></li><li><span><span>　　　RefreshLevel:&nbsp;OleVariant;&nbsp;&nbsp;</span></span></li><li><span><span>　　Begin&nbsp;&nbsp;</span></span></li><li><span><span>　　　IHTMLDocument2(AWebBrowser<span>.</span>Document).Set_CharSet(ACharSet);&nbsp;&nbsp;</span></span></li><li><span><span>　　　RefreshLevel&nbsp;:=<span>7</span>;　　　　　　　　　　　　　　</span><span>//这个7应该从这个应该注册表来，帮助有Bug。</span>&nbsp;&nbsp;</span></li><li><span><span>　　　AWebBrowser<span>.</span>Refresh2(RefreshLevel);&nbsp;&nbsp;</span></span></li><li><span><span>　　End;&nbsp;&nbsp;</span></span></li><li><span><span>&nbsp;&nbsp;</span></span></li><li><span><span>&lt;/pre&gt;&lt;pre&nbsp;name="code"&nbsp;<span>class</span>="delphi"&gt;</span><span>9</span>．将页面中显示的内容全部选中,然后粘贴到Word文档中.&nbsp;&nbsp;</span></li><li><span><span>WebBrowser1<span>.</span>ExecWB(OLECMDID_SELECTALL,&nbsp;OLECMDEXECOPT_DODEFAULT);</span><span>//全选网页</span>&nbsp;&nbsp;</span></li><li><span><span>WebBrowser1<span>.</span>ExecWB(OLECMDID_COPY,&nbsp;OLECMDEXECOPT_DODEFAULT);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//复制网页</span>&nbsp;&nbsp;</span></li><li><span><span>WordDocu<span>.</span>Range</span><span>.</span>Paste;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//word文档粘贴</span>&nbsp;&nbsp;</span></li><li><span><span>WebBrowser1<span>.</span>ExecWB(OLECMDID_UNDO,&nbsp;OLECMDEXECOPT_DODEFAULT);&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//取消全选</span>&nbsp;&nbsp;</span></li><li><span><span>注:WebBrowser的Document属性值和WordDocument的Document属性值必须都不为<span>nil</span>.&nbsp;&nbsp;</span></span></li><li><span><span><span>10</span>．如何解决网页不响应回车事件&nbsp;&nbsp;</span></span></li><li><span><span><span>public</span>&nbsp;&nbsp;</span></span></li><li><span><span>&nbsp;&nbsp;&nbsp;&nbsp;<span>{&nbsp;Public&nbsp;declarations&nbsp;}</span>&nbsp;&nbsp;</span></span></li><li><span><span>&nbsp;&nbsp;&nbsp;&nbsp;<span>procedure</span>&nbsp;MsgHandle(</span><span>var</span>&nbsp;Msg&nbsp;:TMsg;&nbsp;<span>var</span>&nbsp;Handled&nbsp;:Boolean);&nbsp;&nbsp;</span></li><li><span><span><span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span><span>var</span>&nbsp;&nbsp;</span></span></li><li><span><span>Form1:&nbsp;TForm1;&nbsp;&nbsp;</span></span></li><li><span><span>FOleInPlaceActiveObject&nbsp;:IOleInPlaceActiveObject;&nbsp;&nbsp;</span></span></li><li><span><span><span>implementation</span>&nbsp;&nbsp;</span></span></li><li><span><span><span>{$R&nbsp;*.DFM}</span>&nbsp;&nbsp;</span></span></li><li><span><span><span>procedure</span>&nbsp;TForm1</span><span>.</span>MsgHandle(<span>var</span>&nbsp;Msg&nbsp;:TMsg;&nbsp;<span>var</span>&nbsp;Handled&nbsp;:Boolean);&nbsp;&nbsp;</span></li><li><span><span><span>var</span>&nbsp;&nbsp;</span></span></li><li><span><span>iOIPAO&nbsp;:IOleInPlaceActiveObject;&nbsp;&nbsp;</span></span></li><li><span><span>Dispatch&nbsp;:IDispatch;&nbsp;&nbsp;</span></span></li><li><span><span><span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span><span>if</span>&nbsp;WebBrowser1&nbsp;=</span><span>nil</span>&nbsp;<span>then</span>&nbsp;&nbsp;</span></li><li><span><span><span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span>Handled&nbsp;:=False;&nbsp;&nbsp;</span></span></li><li><span><span>Exit;&nbsp;&nbsp;</span></span></li><li><span><span><span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span>Handled&nbsp;:=(IsDialogMessage(WebBrowser1<span>.</span>Handle,&nbsp;Msg)&nbsp;=True);&nbsp;&nbsp;</span></span></li><li><span><span><span>if</span>&nbsp;(Handled)&nbsp;</span><span>and</span>&nbsp;(<span>not</span>&nbsp;WebBrowser1<span>.</span>Busy)&nbsp;<span>then</span>&nbsp;&nbsp;</span></li><li><span><span><span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span><span>if</span>&nbsp;FOleInPlaceActiveObject&nbsp;=</span><span>nil</span>&nbsp;<span>then</span>&nbsp;&nbsp;</span></li><li><span><span><span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span>&nbsp;&nbsp;&nbsp;Dispatch&nbsp;:=WebBrowser1<span>.</span>Application;&nbsp;&nbsp;</span></span></li><li><span><span>&nbsp;&nbsp;&nbsp;<span>if</span>&nbsp;Dispatch&nbsp;&lt;&gt;</span><span>nil</span>&nbsp;<span>then</span>&nbsp;&nbsp;</span></li><li><span><span>&nbsp;&nbsp;&nbsp;<span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span>&nbsp;&nbsp;&nbsp;&nbsp;Dispatch<span>.</span>QueryInterface(IOleInPlaceActiveObject,&nbsp;iOIPAO);&nbsp;&nbsp;</span></span></li><li><span><span>&nbsp;&nbsp;&nbsp;&nbsp;<span>if</span>&nbsp;iOIPAO&nbsp;&lt;&gt;</span><span>nil</span>&nbsp;<span>then</span>&nbsp;&nbsp;</span></li><li><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOleInPlaceActiveObject&nbsp;:=iOIPAO;&nbsp;&nbsp;</span></span></li><li><span><span>&nbsp;&nbsp;&nbsp;<span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span><span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span><span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span><span>if</span>&nbsp;FOleInPlaceActiveObject&nbsp;&lt;&gt;</span><span>nil</span>&nbsp;<span>then</span>&nbsp;&nbsp;</span></li><li><span><span><span>if</span>&nbsp;((Msg</span><span>.</span>message&nbsp;=WM_KEYDOWN)&nbsp;<span>or</span>&nbsp;(Msg<span>.</span>Message&nbsp;=WM_KEYUP))&nbsp;<span>and</span>&nbsp;((Msg<span>.</span>wParam&nbsp;=VK_BACK)&nbsp;<span>or</span>&nbsp;(Msg<span>.</span>wParam&nbsp;=VK_LEFT)&nbsp;<span>or</span>&nbsp;(Msg<span>.</span>wParam&nbsp;=VK_RIGHT))&nbsp;<span>then</span>&nbsp;&nbsp;</span></li><li><span><span><span>else</span>&nbsp;&nbsp;</span></span></li><li><span><span>&nbsp;&nbsp;&nbsp;FOleInPlaceActiveObject<span>.</span>TranslateAccelerator(Msg);&nbsp;&nbsp;</span></span></li><li><span><span><span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span><span>procedure</span>&nbsp;TForm1</span><span>.</span>FormCreate(Sender:&nbsp;TObject);&nbsp;&nbsp;</span></li><li><span><span><span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span>Application<span>.</span>OnMessage&nbsp;:=MsgHandle;&nbsp;&nbsp;</span></span></li><li><span><span><span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span><span>procedure</span>&nbsp;TForm1</span><span>.</span>FormDestroy(Sender:&nbsp;TObject);&nbsp;&nbsp;</span></li><li><span><span><span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span>FOleInPlaceActiveObject&nbsp;:=<span>nil</span>;&nbsp;&nbsp;</span></span></li><li><span><span><span>end</span>;&nbsp;&nbsp;</span></span></li><li><span><span>&nbsp;&nbsp;</span></span></li><li><span><span>&lt;/pre&gt;&lt;pre&nbsp;name="code"&nbsp;<span>class</span>="delphi"&gt;</span><span>//在WebBrowser加载html页面完成后,在页面顶端插入HTML代码</span>&nbsp;&nbsp;</span></li><li><span><span><span>procedure</span>&nbsp;TForm1</span><span>.</span>Button1Click(Sender:&nbsp;TObject);&nbsp;&nbsp;</span></li><li><span><span><span>var</span>&nbsp;&nbsp;</span></span></li><li><span><span>Range:&nbsp;IHTMLTxtRange;&nbsp;&nbsp;</span></span></li><li><span><span><span>begin</span>&nbsp;&nbsp;</span></span></li><li><span><span>Range&nbsp;:=&nbsp;((WebBrowser1<span>.</span>Document&nbsp;</span><span>as</span>&nbsp;IHTMLDocument2).body&nbsp;<span>as</span>&nbsp;&nbsp;</span></li><li><span><span>&nbsp;&nbsp;&nbsp;&nbsp;IHTMLBodyElement).createTextRange;&nbsp;&nbsp;</span></span></li><li><span><span>Range<span>.</span>collapse(False);&nbsp;&nbsp;</span></span></li><li><span><span>Range<span>.</span>pasteHTML(</span><span>'&lt;br/&gt;&lt;b&gt;Hello!&lt;/b&gt;'</span>);&nbsp;&nbsp;</span></li><li><span><span><span>end</span>;&nbsp;</span></span></li></ul>                                    
                    
</div>
</body>

</html>
